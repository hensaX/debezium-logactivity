//  insert
curl --location 'http://localhost:8083/connectors' \
--header 'Content-Type: application/json' \
--data-raw '{
  "name": "pg-log-activity",
  "config": {
    "connector.class": "io.debezium.connector.postgresql.PostgresConnector",

    "database.hostname": "host.docker.internal",
    "database.port": "5444",
    "database.user": "hendra",
    "database.password": "hendra@123",
    "database.dbname": "hendradb",

    "plugin.name": "pgoutput",

    "topic.prefix": "cdc",

    "table.include.list": "public.users,public.roles",

    "transforms": "route",
    "transforms.route.type": "org.apache.kafka.connect.transforms.RegexRouter",
    "transforms.route.regex": ".*",
    "transforms.route.replacement": "log-activity",

    "snapshot.mode": "never",
    "tombstones.on.delete": "false",
    "decimal.handling.mode": "string",
    "time.precision.mode": "connect"
  }
}'

// delete
curl -X DELETE http://localhost:8083/connectors/{nama_connector}

// edit
curl -X PUT http://localhost:8083/connectors/{nama_connector}/config \
  -H "Content-Type: application/json" \
  -d '{
    "connector.class": "io.debezium.connector.postgresql.PostgresConnector",
    "database.hostname": "host.docker.internal",
    "database.port": "5444",
    "database.user": "account-service",
    "database.password": "hendra@123",
    "database.dbname": "account-service",
    "plugin.name": "pgoutput",
    "topic.prefix": "cdc",
    "table.include.list": "public.users,public.roles",
    "transforms": "route",
    "transforms.route.type": "org.apache.kafka.connect.transforms.RegexRouter",
    "transforms.route.regex": ".*",
    "transforms.route.replacement": "log-activity-account-service"
  }'

// get 
curl http://localhost:8083/connectors/{nama_connector}/status | jq



-- additonal config with 1 table 1 topic
{
    "name": "pg-connector",
    "config": {
        "connector.class": "io.debezium.connector.postgresql.PostgresConnector",
        "database.hostname": "host.docker.internal",
        "database.port": "5444",
        "database.user": "hendra",
        "database.password": "hendra@123",
        "database.dbname": "hendra",
        "database.server.name": "hendra",
        "plugin.name": "pgoutput",
        "table.include.list": "public.users",
        "topic.prefix": "cdc"
    }
}

// config dengan 1 topic
{
    "connector.class": "io.debezium.connector.postgresql.PostgresConnector",
    "database.hostname": "host.docker.internal",
    "database.port": "5444",
    "database.user": "hendra",
    "database.password": "hendra@123",
    "database.dbname": "hendra",
    "plugin.name": "pgoutput",
    "topic.prefix": "cdc",
    "table.include.list": "public.users",
    "transforms": "route",
    "transforms.route.type": "org.apache.kafka.connect.transforms.RegexRouter",
    "transforms.route.regex": ".*",
    "transforms.route.replacement": "log-activity"
}